# Source Code - Google Apps Script Files

This folder contains all the Google Apps Script (`.gs`) files for the Canvas AI Grading tool.

## üìÅ Files Overview

These files work together to provide AI-powered grading and feedback for Canvas LMS assignments.

### Core Files

| File | Lines | Purpose |
|------|-------|---------|
| [Constants.gs](Constants.gs) | ~10 | Configuration constants and defaults |
| [Toast.gs](Toast.gs) | ~10 | Toast notification helper functions |
| [ConfigHelpers.gs](ConfigHelpers.gs) | ~80 | Settings and configuration management |
| [APIKeyHelpers.gs](APIKeyHelpers.gs) | ~100 | Secure API key storage and retrieval |

### Integration Files

| File | Lines | Purpose |
|------|-------|---------|
| [CanvasAPIHelpers.gs](CanvasAPIHelpers.gs) | ~500 | Canvas LMS API integration |
| [ClaudeAPIHelpers.gs](ClaudeAPIHelpers.gs) | ~280 | Claude AI API integration |

### Utility Files

| File | Lines | Purpose |
|------|-------|---------|
| [SheetUtilities.gs](SheetUtilities.gs) | ~300 | Google Sheets utilities & menu system |
| [SheetProcessingHelpers.gs](SheetProcessingHelpers.gs) | ~350 | Data processing and parsing |
| [AIOperationContext.gs](AIOperationContext.gs) | ~150 | Context initialization for AI operations |

### Feature Files

| File | Lines | Purpose |
|------|-------|---------|
| [FetchData.gs](FetchData.gs) | ~365 | Fetch questions and submissions from Canvas |
| [GradingTools.gs](GradingTools.gs) | ~370 | AI grading and feedback generation |
| [UploadData.gs](UploadData.gs) | ~200 | Upload grades and comments to Canvas |

## üöÄ Installation

### Recommended: Use the Template Spreadsheet

The easiest way to use these scripts is to copy our template spreadsheet, which has all code pre-installed:

**[üìã Copy Template Spreadsheet](https://docs.google.com/spreadsheets/d/1e2AKNNvqC4knz_jcwL0FVTWHY3bmk1ll9-cL0XQGIeY/edit?usp=sharing)**

### Advanced: Manual Installation

If you prefer to install manually:

1. Create a new Google Spreadsheet
2. Open **Extensions** ‚Üí **Apps Script**
3. For each file in this folder:
   - Create a new script file with the same name
   - Copy and paste the code
4. Save and refresh your spreadsheet

See detailed instructions in [SETUP.md](../SETUP.md).

## üìö Documentation

For detailed explanation of each file's functions and usage:
- [FILE_DESCRIPTIONS.md](../FILE_DESCRIPTIONS.md) - Comprehensive file documentation
- [SETUP.md](../SETUP.md) - Setup and installation guide
- [README.md](../README.md) - Main project documentation

## üîó Dependencies

### External APIs
- **Canvas LMS API**: For fetching questions, submissions, and uploading results
- **Anthropic Claude API**: For AI-powered grading and feedback generation

### Google Services
- **Google Apps Script**: Runtime environment
- **Google Sheets**: User interface and data storage
- **Script Properties**: Secure API key storage

## üîí Security Notes

- **API Keys**: Never commit API keys to version control
- **Script Properties**: Used for secure, encrypted storage
- **FERPA Compliance**: All student data remains in authorized educational systems
- See [SECURITY.md](../SECURITY.md) for complete security guidelines

## üõ†Ô∏è Development

### Code Style
- Use JSDoc comments for functions
- Follow Google Apps Script naming conventions
- Keep functions focused and single-purpose
- Add logging for debugging

### Testing
1. Create a test spreadsheet
2. Use small datasets
3. Check Apps Script execution logs
4. Test error conditions

### Contributing
See [CONTRIBUTING.md](../CONTRIBUTING.md) for guidelines on:
- Reporting bugs
- Suggesting features
- Submitting pull requests
- Code review process

## üìä File Statistics

- **Total Lines**: ~2,700
- **Total Files**: 12
- **Languages**: JavaScript (Google Apps Script)
- **APIs**: Canvas LMS, Anthropic Claude

## ‚ö° Quick Reference

### Key Functions by Use Case

**Fetching Data** (Canvas Tools Menu):
- `fetchAndPopulateQuestionPrompts()` - Import questions, prompts, and rubrics to "Answers" sheet
- `fetchAndPopulateQuizResponses()` - Download student submissions to main sheet

**AI Grading** (Grading Tools Menu):
- `autoGradeWithClaude()` - Grade using overall answer keys (Column C)
- `aiRubricGrade()` - Grade using Canvas rubrics (Columns E+)
- `generateAIComments()` - Generate feedback without rubrics
- `aiRubricComment()` - Generate rubric-based feedback

**Uploading Results** (Canvas Tools Menu):
- `uploadEssayGradesToCanvas()` - Upload grades and comments to Canvas

**Sheet Management** (Sheet Tools Menu):
- `clearGradesAndOrComments()` - Clear grades and/or comments from main sheet
- `setupSettingsSheet_()` - Create or verify Settings sheet

**Menu System** (SheetUtilities.gs):
- `onOpen()` - Creates three menus: Canvas Tools, Grading Tools, Sheet Tools

## üìù License

MIT License - See [LICENSE](../LICENSE) for details

---

**Need Help?** 
- Check [SETUP.md](../SETUP.md) for setup instructions
- Review [FILE_DESCRIPTIONS.md](../FILE_DESCRIPTIONS.md) for detailed documentation
- Open an issue on GitHub for support
